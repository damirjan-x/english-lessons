# Архитектурная схема

## Компоненты системы

```
                    ┌─────────────────────────────────────────┐
                    │           Пользователь (браузер)          │
                    └─────────────────────┬─────────────────────┘
                                        │ HTTP
                                        ▼
┌───────────────────────────────────────────────────────────────────────────┐
│                         Frontend (статическая раздача)                     │
│  /  → index.html   /static/css/styles.css   /static/js/app.js              │
│  Форма: год, месяц, студент, GrammarE…WritingH, hours, Send data, Print   │
└─────────────────────┬─────────────────────────────────────────────────────┘
                      │ HTTP (fetch)
                      ▼
┌───────────────────────────────────────────────────────────────────────────┐
│                    Backend (FastAPI), порт 8000                             │
│  /health          → проверка БД                                           │
│  /api/students    → GET/POST список студентов                              │
│  /api/lessons     → GET/POST данные занятий (student_id, year, month)      │
│  /api/report/pdf  → генерация PDF по шаблону .docx                         │
│  /metrics         → Prometheus                                              │
│  /docs, /redoc    → документация API                                       │
└───────┬─────────────────────────────────────┬─────────────────────────────┘
        │ SQL                                 │ шаблон .docx → LibreOffice → PDF
        ▼                                     ▼
┌───────────────────┐                 ┌───────────────────┐
│  MySQL             │                 │  templates/       │
│  students          │                 │  report_template   │
│  lesson_records    │                 │  .docx             │
└───────────────────┘                 └───────────────────┘
```

## Развёртывание (Kubernetes)

```
                    Ingress (опционально)
                           │
                           ▼
┌─────────────────────────────────────────────────────────────────┐
│  Kubernetes                                                      │
│  ┌─────────────────────────────────────────────────────────────┐│
│  │  Deployment: english-lessons                                 ││
│  │  Pod(s): backend (FastAPI + static) + LibreOffice            ││
│  └──────────────────────────┬──────────────────────────────────┘│
│                              │                                   │
│  ┌──────────────────────────▼──────────────────────────────────┐│
│  │  Service: english-lessons (ClusterIP, port 8000)             ││
│  └─────────────────────────────────────────────────────────────┘│
└─────────────────────────────────────────────────────────────────┘
                           │
                           ▼
              MySQL (вне кластера или отдельный сервис/RDS)
```

## Поток данных

1. **Send data**: форма → POST `/api/lessons` → backend → MySQL (insert/update по student_id + year + month).
2. **Print report**: форма → GET `/api/report/pdf?…` → backend загружает запись из MySQL, заполняет шаблон .docx, конвертирует в PDF через LibreOffice → ответ с файлом PDF.
3. **Загрузка формы**: при смене года/месяца/студента → GET `/api/lessons?…` → подстановка полей из ответа.
